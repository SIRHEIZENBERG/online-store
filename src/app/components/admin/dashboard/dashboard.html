<div class="dashboard">
  <header class="dashboard-header">
    <div class="header-content">
      <h1>Admin Dashboard</h1>
      <div class="header-actions">
        <button class="btn-add" (click)="openAddForm()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="12" y1="5" x2="12" y2="19" />
            <line x1="5" y1="12" x2="19" y2="12" />
          </svg>
          Add Product
        </button>
        <button class="btn-logout" (click)="logout()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
            <polyline points="16 17 21 12 16 7" />
            <line x1="21" y1="12" x2="9" y2="12" />
          </svg>
          Logout
        </button>
      </div>
    </div>
  </header>

  <div class="products-container">
    <div class="products-header">
      <h2>Products</h2>
      <span class="product-count">{{ products.length }} total</span>
    </div>

    <!-- Desktop Table View -->
    <div class="products-table" *ngIf="paginatedProducts.length > 0; else noProducts">
      <table>
        <thead>
          <tr>
            <th>Image</th>
            <th>Title</th>
            <th>Price</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let product of paginatedProducts">
            <td>
              <div class="product-image">
                <img [src]="product.imageUrl[0]" [alt]="product?.title" />
              </div>
            </td>
            <td>
              <div class="product-title">{{ product.title }}</div>
            </td>
            <td>
              <div class="product-price">KES {{ product.price | number: '1.2-2' }}</div>
            </td>
            <td>
              <div class="action-buttons">
                <button class="btn-action btn-view" (click)="viewProduct(product)" title="View">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                    <circle cx="12" cy="12" r="3" />
                  </svg>
                </button>
                <button class="btn-action btn-edit" (click)="openEditForm(product)" title="Edit">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                  </svg>
                </button>
                <button class="btn-action btn-delete" (click)="onDelete(product.id)" title="Delete">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="3 6 5 6 21 6" />
                    <path
                      d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                    />
                  </svg>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Mobile Card View -->
    <div class="products-cards" *ngIf="paginatedProducts.length > 0">
      <div class="product-card" *ngFor="let product of paginatedProducts">
        <div class="card-image">
          <img [src]="product.imageUrl[0]" [alt]="product?.title" />
        </div>
        <div class="card-content">
          <h3 class="card-title">{{ product.title }}</h3>
          <p class="card-price">KES {{ product.price | number: '1.2-2' }}</p>
          <div class="card-actions">
            <button class="btn-card btn-view" (click)="viewProduct(product)">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                <circle cx="12" cy="12" r="3" />
              </svg>
              View
            </button>
            <button class="btn-card btn-edit" (click)="openEditForm(product)">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
              </svg>
              Edit
            </button>
            <button class="btn-card btn-delete" (click)="onDelete(product.id)">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="3 6 5 6 21 6" />
                <path
                  d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                />
              </svg>
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="products.length > itemsPerPage">
      <button
        class="pagination-btn"
        (click)="goToPage(currentPage - 1)"
        [disabled]="currentPage === 1"
      >
        <svg
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <polyline points="15 18 9 12 15 6" />
        </svg>
      </button>

      <div class="pagination-numbers">
        <button
          *ngFor="let page of pageNumbers"
          class="pagination-number"
          [class.active]="page === currentPage"
          (click)="goToPage(page)"
        >
          {{ page }}
        </button>
      </div>

      <button
        class="pagination-btn"
        (click)="goToPage(currentPage + 1)"
        [disabled]="currentPage === totalPages"
      >
        <svg
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <polyline points="9 18 15 12 9 6" />
        </svg>
      </button>
    </div>

    <ng-template #noProducts>
      <div class="no-products">
        <svg
          width="64"
          height="64"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="1.5"
        >
          <rect x="1" y="4" width="22" height="16" rx="2" ry="2" />
          <line x1="1" y1="10" x2="23" y2="10" />
        </svg>
        <h3>No products yet</h3>
        <p>Click "Add Product" to get started!</p>
      </div>
    </ng-template>
  </div>

  <!-- Modal Form (keeping your existing form structure) -->
  <div class="modal" *ngIf="showForm">
    <div class="modal-overlay" (click)="closeForm()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h2>{{ editMode ? 'Edit Product' : 'Add New Product' }}</h2>
        <button class="modal-close" (click)="closeForm()">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
      </div>

      <form (ngSubmit)="onSubmit()" #productForm="ngForm">
        <div class="form-group">
          <label for="title">Product Title *</label>
          <input
            type="text"
            id="title"
            [(ngModel)]="product.title"
            name="title"
            required
            placeholder="e.g., Wireless Headphones"
          />
        </div>

        <div class="form-group">
          <label for="price">Price (KES) *</label>
          <input
            type="number"
            id="price"
            [(ngModel)]="product.price"
            name="price"
            required
            min="0"
            step="0.01"
            placeholder="e.g., 2500"
          />
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea
            id="description"
            [(ngModel)]="product.description"
            name="description"
            rows="4"
            placeholder="Product description..."
          ></textarea>
        </div>

        <div class="form-group">
          <label for="image">Product Images *</label>
          <input
            type="file"
            id="image"
            (change)="onImageUpload($event)"
            accept="image/*"
            multiple
            [disabled]="uploading"
          />
          <small>Max 5MB per image. JPG, PNG, or GIF. Select multiple files at once.</small>

          <div class="upload-status" *ngIf="uploading">
            <svg
              class="spinner"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 12a9 9 0 1 1-6.219-8.56" />
            </svg>
            <p>Uploading images...</p>
          </div>

          <div class="upload-error" *ngIf="uploadError">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10" />
              <line x1="12" y1="8" x2="12" y2="12" />
              <line x1="12" y1="16" x2="12.01" y2="16" />
            </svg>
            <p>{{ uploadError }}</p>
          </div>

          <div class="images-preview-grid" *ngIf="product.imageUrl && product.imageUrl.length > 0">
            <div class="image-preview" *ngFor="let url of product.imageUrl; let i = index">
              <img [src]="url" alt="Product image {{ i + 1 }}" />
              <button
                type="button"
                class="remove-image-btn"
                (click)="removeImage(i)"
                title="Remove image"
              >
                Ã—
              </button>
              <span class="image-number">{{ i + 1 }}</span>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="closeForm()">Cancel</button>
          <button
            type="submit"
            class="btn-submit"
            [disabled]="!productForm.valid || !product.imageUrl || uploading"
          >
            {{ editMode ? 'Update' : 'Add' }} Product
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
